N_DEFPARSER(number,N_ARRAY(N_UINT(uint8_t,h_int_range(h_bits(8,false),'0','9')),h_many1))
N_DEFPARSER(varidentifier,N_WRAP(N_CONSTANT(N_PARSER(WHITE)),N_ARRAY(N_UINT(uint8_t,h_int_range(h_bits(8,false),'a','z')),h_many1),))
N_DEFPARSER(constidentifier,N_ARRAY(N_UINT(uint8_t,h_int_range(h_bits(8,false),'A','Z')),h_many1))
N_DEFPARSER(WHITE,N_ARRAY(N_CHOICE(N_OPTION(U1,N_UINT(uint8_t,h_int_range(h_bits(8,false),' ',' '))) N_OPTION(U2,N_UINT(uint8_t,h_int_range(h_bits(8,false),'\n','\n')))),h_many))
N_DEFPARSER(SEPERATOR,N_CHOICE(N_OPTION(U1,N_UINT(uint8_t,h_int_range(h_bits(8,false),'\n','\n'))) N_OPTION(U2,N_UINT(uint8_t,h_int_range(h_bits(8,false),';',';')))))
N_DEFPARSER(intconstant,N_WRAP(N_CONSTANT(N_PARSER(WHITE)),N_CHOICE(N_OPTION(NUMBER,N_PARSER(number))N_OPTION(ASCII,N_WRAP(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("'")))),N_CHOICE(N_OPTION(escape,N_WRAP(N_CONSTANT(N_UINT(uint8_t,h_int_range(h_bits(8,false),'\\','\\'))),N_UINT(uint8_t,h_bits(8,false)),))N_OPTION(direct,N_UINT(uint8_t,h_bits(8,false)))),N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("'"))))))),))
N_DEFPARSER(intp,N_CHOICE(N_OPTION(UNSIGNED,N_STRUCT(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("uint"))))N_FIELD(length,N_ARRAY(N_UINT(uint8_t,h_int_range(h_bits(8,false),'0','9')),h_many1))))N_OPTION(SIGNED,N_STRUCT(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("int"))))N_FIELD(length,N_ARRAY(N_UINT(uint8_t,h_int_range(h_bits(8,false),'0','9')),h_many1))))))
N_DEFPARSER(constint,N_STRUCT(N_FIELD(parser,N_PARSER(intp))N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("="))))N_FIELD(value,N_PARSER(intconstant))))
N_DEFPARSER(arrayvalue,N_CHOICE(N_OPTION(STRING,N_WRAP(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(N_UINT(uint8_t,h_int_range(h_bits(8,false),'"','"'))),N_ARRAY(N_UINT(uint8_t,h_not_in((char []){'"'}, strlen((char[]){'"'}))),h_many),N_CONSTANT(N_UINT(uint8_t,h_int_range(h_bits(8,false),'"','"')))))N_OPTION(VALUES,N_WRAP(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("[")))),N_ARRAY(N_PARSER(intconstant),h_many),N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("]"))))))))
N_DEFPARSER(constarray,N_STRUCT(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("many"))))N_FIELD(parser,N_PARSER(intp))N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("="))))N_FIELD(value,N_PARSER(arrayvalue))))
N_DEFPARSER(constfield,N_CHOICE(N_OPTION(ARRAY,N_PARSER(constarray))N_OPTION(INT,N_PARSER(constint))N_OPTION(REF,N_PARSER(constidentifier))))
N_DEFPARSER(intconstraint,N_CHOICE(N_OPTION(RANGE,N_STRUCT(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("["))))N_FIELD(min,N_OPTIONAL(N_PARSER(intconstant)))N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok(".."))))N_FIELD(max,N_OPTIONAL(N_PARSER(intconstant)))N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("]"))))))N_OPTION(SET,N_WRAP(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("[")))),N_SEPBY1(N_PARSER(intconstant),N_UINT(uint8_t,h_int_range(h_bits(8,false),',',','))),N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("]"))))))N_OPTION(NEGATE,N_WRAP(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("!")))),N_REF(intconstraint),))))
N_DEFPARSER(constrainedint,N_STRUCT(N_FIELD(parser,N_PARSER(intp))N_FIELD(constraint,N_OPTIONAL(N_WRAP(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("|")))),N_PARSER(intconstraint),)))))
N_DEFPARSER(structparser,N_WRAP(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("{")))),N_SEPBY(N_CHOICE(N_OPTION(constant,N_PARSER(constfield))N_OPTION(field,N_STRUCT(N_FIELD(name,N_PARSER(varidentifier))N_FIELD(parser,N_REF(parser))))),N_PARSER(SEPERATOR)),N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("}"))))))
N_DEFPARSER(wrapparser,N_STRUCT(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("<"))))N_FIELD(const_before,N_OPTIONAL(N_WRAP(,N_SEPBY1(N_PARSER(constfield),N_PARSER(SEPERATOR)),N_CONSTANT(N_PARSER(SEPERATOR)))))N_FIELD(parser,N_REF(parser))N_FIELD(const_after,N_SEPBY(N_PARSER(constfield),N_PARSER(SEPERATOR)))N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok(">"))))))
N_DEFPARSER(choiceparser,N_WRAP(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("choose")))) N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("{")))),N_ARRAY(N_STRUCT(N_FIELD(tag,N_PARSER(varidentifier))N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("="))))N_FIELD(parser,N_REF(parser))),h_many),N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("}"))))))
N_DEFPARSER(arrayparser,N_CHOICE(N_OPTION(MANY,N_WRAP(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("many")))),N_REF(parser),))N_OPTION(MANYONE,N_WRAP(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("many1")))),N_REF(parser),))N_OPTION(SEPBY,N_STRUCT(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("sepBy"))))N_FIELD(seperator,N_REF(parser))N_FIELD(inner,N_REF(parser))))N_OPTION(SEPBYONE,N_STRUCT(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("sepBy1"))))N_FIELD(seperator,N_REF(parser))N_FIELD(inner,N_REF(parser))))))
N_DEFPARSER(parser,N_CHOICE(N_OPTION(PICK1,N_CHOICE(N_OPTION(INT,N_PARSER(constrainedint))N_OPTION(STRUCT,N_PARSER(structparser))N_OPTION(WRAP,N_PARSER(wrapparser))N_OPTION(CHOICE,N_PARSER(choiceparser))N_OPTION(OPTIONAL,N_WRAP(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("optional")))),N_REF(parser),))N_OPTION(UNION,N_SEPBY1(N_REF(parser),N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("||")))))N_OPTION(REF,N_WRAP(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("*")))),N_PARSER(varidentifier),))N_OPTION(NAME,N_PARSER(varidentifier)))) N_OPTION(PICK2,N_WRAP(N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok("(")))),N_REF(parser),N_CONSTANT(N_STRUCT(N_CONSTANT(N_PARSER(WHITE)) N_CONSTANT(h_tok(")"))))))))
N_DEFPARSER(definition,N_CHOICE(N_OPTION(PARSER,N_STRUCT(N_FIELD(name,N_PARSER(varidentifier))N_CONSTANT(N_PARSER(WHITE))N_CONSTANT(N_UINT(uint8_t,h_int_range(h_bits(8,false),'=','=')))N_CONSTANT(N_PARSER(WHITE))N_FIELD(definition,N_PARSER(parser))))N_OPTION(CONST,N_STRUCT(N_FIELD(name,N_PARSER(constidentifier))N_CONSTANT(N_PARSER(WHITE))N_CONSTANT(N_UINT(uint8_t,h_int_range(h_bits(8,false),'=','=')))N_CONSTANT(N_PARSER(WHITE))N_FIELD(definition,N_PARSER(parser))))))
N_DEFPARSER(grammar,N_ARRAY(N_PARSER(definition),h_many))

