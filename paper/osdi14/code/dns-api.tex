\begin{Verbatim}[commandchars=\\\{\},codes={\catcode`\$=3\catcode`\^=7\catcode`\_=8}]
\PY{k}{struct} \PY{n}{dnspacket}\PY{o}{*}\PY{n+nf}{parse\PYZus{}dnspacket}\PY{p}{(}\PY{n}{NailArena} \PY{o}{*}\PY{n}{arena}\PY{p}{,} 
  \PY{k}{const} \PY{k+kt}{uint8\PYZus{}t} \PY{o}{*}\PY{n}{data}\PY{p}{,} 
  \PY{k+kt}{size\PYZus{}t} \PY{n}{size}\PY{p}{)}\PY{p}{;}
\PY{k+kt}{int} \PY{n+nf}{gen\PYZus{}dnspacket}\PY{p}{(}\PY{n}{NailArena} \PY{o}{*}\PY{n}{tmp\PYZus{}arena}\PY{p}{,}
  \PY{n}{NailStream} \PY{o}{*}\PY{n}{out}\PY{p}{,}
  \PY{k}{struct} \PY{n}{dnspacket} \PY{o}{*} \PY{n}{val}\PY{p}{)} \PY{p}{;}
\end{Verbatim}
